import axios from 'axios';

// Define API endpoints for NovaPoshta and Ukrposhta
const NOVA_POSHTA_API_ENDPOINT = 'https://api.novaposhta.ua/v2.0/json/';
const UKRPOSHTA_API_ENDPOINT = 'https://dev.ukrposhta.ua/ecom/0.0.1/'; 

// Function to calculate shipping rates for NovaPoshta
function calculateNovaPoshtaShippingRate(weight, destination) {
    axios.post(NOVA_POSHTA_API_ENDPOINT, {
        modelName: 'InternetDocument',
        calledMethod: 'getDocumentPrice',
        methodProperties: {
            Weight: weight,
            ServiceType: 'WarehouseWarehouse',
            CitySender: 'city_ref',
            CityRecipient: destination,
            Cost: '0',
            CargoType: 'Cargo',
            SeatsAmount: '1'
        }
    })
    .then(response => {
        const shippingRate = response.data.data[0].Cost;
        displayShippingRate(shippingRate, 'NovaPoshta');
    })
    .catch(error => {
        console.error('NovaPoshta - Error calculating shipping rate:', error);
    });
}

// Function to calculate shipping rates for Ukrposhta
function calculateUkrposhtaShippingRate(weight, destination) {
    axios.get(`${UKRPOSHTA_API_ENDPOINT}/calculate/delivery-price`, {
        params: {
            Weight: weight,
            ServiceType: 'WarehouseWarehouse',
            CitySender: 'sender_city',
            CityRecipient: destination,
            Cost: '0',
            CargoType: 'Cargo',
            SeatsAmount: '1'
        }
    })
    .then(response => {
        const shippingRate = response.data.data[0].Cost;
        displayShippingRate(shippingRate, 'Ukrposhta');
    })
    .catch(error => {
        console.error('Ukrposhta - Error calculating shipping rate:', error);
    });
}

// Function to display shipping rates
function displayShippingRate(shippingRate, provider) {
    console.log(`Shipping rate for ${provider}: ${shippingRate}`);
    // Implement further display logic (e.g., updating the UI)
}

// Function to submit shipping information to the server
function submitShippingInformation(shippingInformation) {
    axios.post('/api/method/shipping_info', shippingInformation)
    .then(response => {
        console.log('Shipping information submitted successfully:', response.data);
    })
    .catch(error => {
        console.error('Error submitting shipping information:', error);
    });
}

// Export functions for use in other modules
export { calculateNovaPoshtaShippingRate, calculateUkrposhtaShippingRate, submitShippingInformation };
